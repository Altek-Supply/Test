{"ast":null,"code":"var _jsxFileName = \"E:\\\\Sani\\\\Documents\\\\Smart Search Github Pages\\\\Test\\\\src\\\\components\\\\ImportFile.js\";\nimport React from 'react';\nimport * as XLSX from 'xlsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ImportFile = _ref => {\n  let {\n    selectedData\n  } = _ref;\n  const handleDownload = () => {\n    console.log('Selected Data in importfile is:', selectedData);\n    // Create a new workbook\n    const workbook = XLSX.utils.book_new();\n    // Format the selectedData into the appropriate format (array of arrays)\n    const sheetData = selectedData.map(_ref2 => {\n      let {\n        item,\n        name\n      } = _ref2;\n      return [name, item[0], item[1]];\n    });\n    // Create a new worksheet\n    const worksheet = XLSX.utils.aoa_to_sheet([['Searched', 'Tag No', 'Description'], ...sheetData]);\n    // Add the worksheet to the workbook\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'SelectedData');\n    // Convert the workbook to a binary string\n    const excelFile = XLSX.write(workbook, {\n      type: 'binary'\n    });\n    // Create a blob with the binary data and create a download link\n    const blob = new Blob([s2ab(excelFile)], {\n      type: 'application/octet-stream'\n    });\n    const url = URL.createObjectURL(blob);\n    // Trigger the download\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'selected_data.xlsx';\n    a.click();\n    // Cleanup\n    URL.revokeObjectURL(url);\n  };\n\n  // Convert a string to an array buffer\n  const s2ab = s => {\n    const buf = new ArrayBuffer(s.length);\n    const view = new Uint8Array(buf);\n    for (let i = 0; i !== s.length; ++i) view[i] = s.charCodeAt(i) & 0xff;\n    return buf;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"button-container\",\n    children: /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleDownload,\n      children: \"Download Excel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n};\n_c = ImportFile;\nexport default ImportFile;\nvar _c;\n$RefreshReg$(_c, \"ImportFile\");","map":{"version":3,"names":["React","XLSX","jsxDEV","_jsxDEV","ImportFile","_ref","selectedData","handleDownload","console","log","workbook","utils","book_new","sheetData","map","_ref2","item","name","worksheet","aoa_to_sheet","book_append_sheet","excelFile","write","type","blob","Blob","s2ab","url","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","s","buf","ArrayBuffer","length","view","Uint8Array","i","charCodeAt","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["E:/Sani/Documents/Smart Search Github Pages/Test/src/components/ImportFile.js"],"sourcesContent":["import React from 'react';\r\nimport * as XLSX from 'xlsx';\r\n\r\nconst ImportFile = ({ selectedData }) => {\r\n  const handleDownload = () => {\r\n    console.log('Selected Data in importfile is:', selectedData)\r\n    // Create a new workbook\r\n    const workbook = XLSX.utils.book_new();\r\n    // Format the selectedData into the appropriate format (array of arrays)\r\n    const sheetData = selectedData.map(({ item, name }) => [ name, item[0], item[1] ]);\r\n    // Create a new worksheet\r\n    const worksheet = XLSX.utils.aoa_to_sheet([['Searched', 'Tag No', 'Description'], ...sheetData]);\r\n    // Add the worksheet to the workbook\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'SelectedData');\r\n    // Convert the workbook to a binary string\r\n    const excelFile = XLSX.write(workbook, { type: 'binary' });\r\n    // Create a blob with the binary data and create a download link\r\n    const blob = new Blob([s2ab(excelFile)], { type: 'application/octet-stream' });\r\n    const url = URL.createObjectURL(blob);\r\n    // Trigger the download\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = 'selected_data.xlsx';\r\n    a.click();\r\n    // Cleanup\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  // Convert a string to an array buffer\r\n  const s2ab = (s) => {\r\n    const buf = new ArrayBuffer(s.length);\r\n    const view = new Uint8Array(buf);\r\n    for (let i = 0; i !== s.length; ++i) view[i] = s.charCodeAt(i) & 0xff;\r\n    return buf;\r\n  };\r\n\r\n  return (\r\n    <div className=\"button-container\">\r\n    <button onClick={handleDownload}>Download Excel</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImportFile;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7B,MAAMC,UAAU,GAAGC,IAAA,IAAsB;EAAA,IAArB;IAAEC;EAAa,CAAC,GAAAD,IAAA;EAClC,MAAME,cAAc,GAAGA,CAAA,KAAM;IAC3BC,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEH,YAAY,CAAC;IAC5D;IACA,MAAMI,QAAQ,GAAGT,IAAI,CAACU,KAAK,CAACC,QAAQ,CAAC,CAAC;IACtC;IACA,MAAMC,SAAS,GAAGP,YAAY,CAACQ,GAAG,CAACC,KAAA;MAAA,IAAC;QAAEC,IAAI;QAAEC;MAAK,CAAC,GAAAF,KAAA;MAAA,OAAK,CAAEE,IAAI,EAAED,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,CAAE;IAAA,EAAC;IAClF;IACA,MAAME,SAAS,GAAGjB,IAAI,CAACU,KAAK,CAACQ,YAAY,CAAC,CAAC,CAAC,UAAU,EAAE,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAGN,SAAS,CAAC,CAAC;IAChG;IACAZ,IAAI,CAACU,KAAK,CAACS,iBAAiB,CAACV,QAAQ,EAAEQ,SAAS,EAAE,cAAc,CAAC;IACjE;IACA,MAAMG,SAAS,GAAGpB,IAAI,CAACqB,KAAK,CAACZ,QAAQ,EAAE;MAAEa,IAAI,EAAE;IAAS,CAAC,CAAC;IAC1D;IACA,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACC,IAAI,CAACL,SAAS,CAAC,CAAC,EAAE;MAAEE,IAAI,EAAE;IAA2B,CAAC,CAAC;IAC9E,MAAMI,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;IACrC;IACA,MAAMM,CAAC,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IACrCF,CAAC,CAACG,IAAI,GAAGN,GAAG;IACZG,CAAC,CAACI,QAAQ,GAAG,oBAAoB;IACjCJ,CAAC,CAACK,KAAK,CAAC,CAAC;IACT;IACAP,GAAG,CAACQ,eAAe,CAACT,GAAG,CAAC;EAC1B,CAAC;;EAED;EACA,MAAMD,IAAI,GAAIW,CAAC,IAAK;IAClB,MAAMC,GAAG,GAAG,IAAIC,WAAW,CAACF,CAAC,CAACG,MAAM,CAAC;IACrC,MAAMC,IAAI,GAAG,IAAIC,UAAU,CAACJ,GAAG,CAAC;IAChC,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,KAAKN,CAAC,CAACG,MAAM,EAAE,EAAEG,CAAC,EAAEF,IAAI,CAACE,CAAC,CAAC,GAAGN,CAAC,CAACO,UAAU,CAACD,CAAC,CAAC,GAAG,IAAI;IACrE,OAAOL,GAAG;EACZ,CAAC;EAED,oBACEnC,OAAA;IAAK0C,SAAS,EAAC,kBAAkB;IAAAC,QAAA,eACjC3C,OAAA;MAAQ4C,OAAO,EAAExC,cAAe;MAAAuC,QAAA,EAAC;IAAc;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACnD,CAAC;AAEV,CAAC;AAACC,EAAA,GAtCIhD,UAAU;AAwChB,eAAeA,UAAU;AAAC,IAAAgD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}